# ciqstats badge

This is a Serverless Function for Garmin Connect IQ app downloads,reviews,ratings statistics query.

## Showcase

### Center Aligned with Html

<p align="center">
    Some Apps I love(Hope you won't mind I use your apps as showcase without your permissions) <br>
    <img src="https://img.shields.io/badge/dynamic/json?color=green&logo=garmin&label=Hike2%2B&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D116a5b59-29ae-4397-a70e-907d7e5f8e44%26domain%3Dall"/>
    <img src="https://img.shields.io/badge/dynamic/json?color=blue&label=Run%20Power&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Da054f515-576a-4a28-b8e5-87987ba737e1%26domain%3Dall"/>
    <img src="https://img.shields.io/badge/dynamic/json?&color=orange&label=GRun&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Dbf56e088-aefe-4fb4-8f16-b2e136b996a9%26domain%3Dall"/>
</p>

<p align="center">
    <a href="https://apps.garmin.com/en-US/apps/dc6ceca8-6ec6-49f2-b711-4ebc0d347177">My First Garmin App JumpJump</a> <br>
    <img src="https://img.shields.io/badge/dynamic/json?color=green&label=Downloads&style=for-the-badge&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Ddc6ceca8-6ec6-49f2-b711-4ebc0d347177%26domain%3Dall"/>
    <img src="https://img.shields.io/badge/dynamic/json?color=blue&label=Reviews&query=reviews&style=for-the-badge&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Ddc6ceca8-6ec6-49f2-b711-4ebc0d347177%26domain%3Dall"/>
    <img src="https://img.shields.io/badge/dynamic/json?&color=orange&label=Rating&style=for-the-badge&query=ratings&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Ddc6ceca8-6ec6-49f2-b711-4ebc0d347177%26domain%3Dall"/>
</p>

### Markdown Syntax

Garmin Logo is too small. You can remove it. Waiting for a Connect IQ logo.

#### Different Metrics

##### Total

![Developer Name](https://img.shields.io/badge/dynamic/json?color=blue&label=Developer&style=flat-square&query=developer_name&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Ftotal%3Fappid%3D876cfd5e-4e42-48ca-8869-cd7c59235573%26domain%3Dall)
![Total Downloads](https://img.shields.io/badge/dynamic/json?color=pink&label=Total%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Ftotal%3Fappid%3D876cfd5e-4e42-48ca-8869-cd7c59235573%26domain%3Dall)

##### JumpJmp

![JJ Downloads](https://img.shields.io/badge/dynamic/json?color=green&label=Global%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Ddc6ceca8-6ec6-49f2-b711-4ebc0d347177%26domain%3Dall)
![JJ Downloads COM](https://img.shields.io/badge/dynamic/json?color=green&label=Row%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Ddc6ceca8-6ec6-49f2-b711-4ebc0d347177%26domain%3Dcom)
![JJ Downloads CN](https://img.shields.io/badge/dynamic/json?color=green&label=China%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Ddc6ceca8-6ec6-49f2-b711-4ebc0d347177%26domain%3Dcn)
![JJ Rating COM](https://img.shields.io/badge/dynamic/json?color=blue&label=Row%20Rating&style=flat-square&query=ratings&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Ddc6ceca8-6ec6-49f2-b711-4ebc0d347177%26domain%3Dcom)
![JJ Rating CN](https://img.shields.io/badge/dynamic/json?color=blue&label=China%20Rating&style=flat-square&query=ratings&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Ddc6ceca8-6ec6-49f2-b711-4ebc0d347177%26domain%3Dcn)
![JJ Reviews](https://img.shields.io/badge/dynamic/json?color=orange&label=Reviews&style=flat-square&query=reviews&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Ddc6ceca8-6ec6-49f2-b711-4ebc0d347177%26domain%3Dall)

##### Including the names in Labels is Fine

![Obvious中文版](https://img.shields.io/badge/dynamic/json?color=green&label=Obvious%E4%B8%AD%E6%96%87%E7%89%88%20Global%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Dc430403e-6b89-4de5-af57-621d24c45b8c%26domain%3Dall)
![Obvious中文版](https://img.shields.io/badge/dynamic/json?color=green&label=Obvious%E4%B8%AD%E6%96%87%E7%89%88%20ROW%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Dc430403e-6b89-4de5-af57-621d24c45b8c%26domain%3Dcom)
![Obvious中文版](https://img.shields.io/badge/dynamic/json?color=green&label=Obvious%E4%B8%AD%E6%96%87%E7%89%88%20China%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Dc430403e-6b89-4de5-af57-621d24c45b8c%26domain%3Dcn)
![Obvious中文版](https://img.shields.io/badge/dynamic/json?color=blue&label=Obvious%E4%B8%AD%E6%96%87%E7%89%88%20ROW%20Rating&style=flat-square&query=ratings&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Dc430403e-6b89-4de5-af57-621d24c45b8c%26domain%3Dcom)
![Obvious中文版](https://img.shields.io/badge/dynamic/json?color=blue&label=Obvious%E4%B8%AD%E6%96%87%E7%89%88%20China%20Rating&style=flat-square&query=ratings&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Dc430403e-6b89-4de5-af57-621d24c45b8c%26domain%3Dcn)
![Obvious中文版](https://img.shields.io/badge/dynamic/json?color=orange&label=Obvious%E4%B8%AD%E6%96%87%E7%89%88%20Reviews&style=flat-square&query=reviews&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Dc430403e-6b89-4de5-af57-621d24c45b8c%26domain%3Dall)

![Obvious](https://img.shields.io/badge/dynamic/json?color=green&label=Obvious%20Global%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D9c9c31b1-d080-4c47-955a-496f9435ac32%26domain%3Dall)
![Obvious](https://img.shields.io/badge/dynamic/json?color=green&label=Obvious%20ROW%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D9c9c31b1-d080-4c47-955a-496f9435ac32%26domain%3Dcom)
![Obvious](https://img.shields.io/badge/dynamic/json?color=green&label=Obvious%20China%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D9c9c31b1-d080-4c47-955a-496f9435ac32%26domain%3Dcn)
![Obvious](https://img.shields.io/badge/dynamic/json?color=blue&label=Obvious%20ROW%20Rating&style=flat-square&query=ratings&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D9c9c31b1-d080-4c47-955a-496f9435ac32%26domain%3Dcom)
![Obvious](https://img.shields.io/badge/dynamic/json?color=blue&label=Obvious%20China%20Rating&style=flat-square&query=ratings&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D9c9c31b1-d080-4c47-955a-496f9435ac32%26domain%3Dcn)
![Obvious](https://img.shields.io/badge/dynamic/json?color=orange&label=Obvious%20Reviews&style=flat-square&query=reviews&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D9c9c31b1-d080-4c47-955a-496f9435ac32%26domain%3Dall)

#### App Matrix

[![Obvious中文版](https://img.shields.io/badge/dynamic/json?color=green&label=Obvious%E4%B8%AD%E6%96%87%E7%89%88&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Dc430403e-6b89-4de5-af57-621d24c45b8c%26domain%3Dall)](https://apps.garmin.com/en-US/apps/c430403e-6b89-4de5-af57-621d24c45b8c)
[![Obvious](https://img.shields.io/badge/dynamic/json?color=green&label=Obvious&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D9c9c31b1-d080-4c47-955a-496f9435ac32%26domain%3Dall)](https://apps.garmin.com/en-US/apps/9c9c31b1-d080-4c47-955a-496f9435ac32)
[![青玉案(Obvious Plus中文版)](https://img.shields.io/badge/dynamic/json?color=green&label=%E9%9D%92%E7%8E%89%E6%A1%88%28Obvious%20Plus%E4%B8%AD%E6%96%87%E7%89%88%29&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Da2b783ae-a3cf-44ca-80ec-6a936143281b%26domain%3Dall)](https://apps.garmin.com/en-US/apps/a2b783ae-a3cf-44ca-80ec-6a936143281b)
[![中华黄历](https://img.shields.io/badge/dynamic/json?color=green&label=%E4%B8%AD%E5%8D%8E%E9%BB%84%E5%8E%86&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Da707f466-7753-4882-be4a-e13eb75d19f9%26domain%3Dall)](https://apps.garmin.com/en-US/apps/a707f466-7753-4882-be4a-e13eb75d19f9)
[![Obvious Plus](https://img.shields.io/badge/dynamic/json?color=green&label=Obvious%20Plus&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D38d79bbf-1cb9-4e79-9294-93c74ea16332%26domain%3Dall)](https://apps.garmin.com/en-US/apps/38d79bbf-1cb9-4e79-9294-93c74ea16332)
[![Answers](https://img.shields.io/badge/dynamic/json?color=green&label=Answers&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Db4337e65-9333-49e4-9e7b-27e4f68922a1%26domain%3Dall)](https://apps.garmin.com/en-US/apps/b4337e65-9333-49e4-9e7b-27e4f68922a1)

[![JumpJump(Jump Rope app)](https://img.shields.io/badge/dynamic/json?color=green&label=JumpJump%28Jump%20Rope%20app%29&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3Ddc6ceca8-6ec6-49f2-b711-4ebc0d347177%26domain%3Dall)](https://apps.garmin.com/en-US/apps/dc6ceca8-6ec6-49f2-b711-4ebc0d347177)
[![JumpJump Pro（Jump Rope）](https://img.shields.io/badge/dynamic/json?color=green&label=JumpJump%20Pro%EF%BC%88Jump%20Rope%EF%BC%89&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D80db03b5-86ba-450c-b45a-d666ca83b6dc%26domain%3Dall)](https://apps.garmin.com/en-US/apps/80db03b5-86ba-450c-b45a-d666ca83b6dc)
[![QRCode Wallet | Static QR Code](https://img.shields.io/badge/dynamic/json?color=green&label=QRCode%20Wallet%20%7C%20Static%20QR%20Code&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D77e5e489-2519-4e3f-8e30-6f2bf1f526be%26domain%3Dall)](https://apps.garmin.com/en-US/apps/77e5e489-2519-4e3f-8e30-6f2bf1f526be)
[![二维静码·专业版(需搭配同名微信小程序使用)](https://img.shields.io/badge/dynamic/json?color=green&label=%E4%BA%8C%E7%BB%B4%E9%9D%99%E7%A0%81%C2%B7%E4%B8%93%E4%B8%9A%E7%89%88%28%E9%9C%80%E6%90%AD%E9%85%8D%E5%90%8C%E5%90%8D%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BD%BF%E7%94%A8%29&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D7a8d8132-72d1-47db-aceb-612a92d0692e%26domain%3Dall)](https://apps.garmin.com/en-US/apps/7a8d8132-72d1-47db-aceb-612a92d0692e)
[![Manjianghong](https://img.shields.io/badge/dynamic/json?color=green&label=Manjianghong&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D7a9ea440-3e9c-4f0a-9e9d-5822f5091020%26domain%3Dall)](https://apps.garmin.com/en-US/apps/7a9ea440-3e9c-4f0a-9e9d-5822f5091020)

## Make Your Own

Make your badges here [Shields.io](https://shields.io/#your-badge)

### Batch

```
pip install ciqreviews
```

```

# -*- coding: UTF-8 -*-
import argparse
from connectiq import get_user_app_download_info
import os
import urllib.parse

# Generate multi-badges
developer_name, total_download, app_dict = get_user_app_download_info(
    '876cfd5e-4e42-48ca-8869-cd7c59235573', 'all')

print('{}: total downloads:{} downloads rank;{}'.format(
    developer_name, total_download, app_dict))

template = '''
![{}](https://img.shields.io/badge/dynamic/json?color=green&label={}%20Global%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D{}%26domain%3Dall)
![{}](https://img.shields.io/badge/dynamic/json?color=green&label={}%20ROW%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D{}%26domain%3Dcom)
![{}](https://img.shields.io/badge/dynamic/json?color=green&label={}%20China%20Downloads&style=flat-square&query=downloads&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D{}%26domain%3Dcn)
![{}](https://img.shields.io/badge/dynamic/json?color=blue&label={}%20ROW%20Rating&style=flat-square&query=ratings&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D{}%26domain%3Dcom)
![{}](https://img.shields.io/badge/dynamic/json?color=blue&label={}%20China%20Rating&style=flat-square&query=ratings&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D{}%26domain%3Dcn)
![{}](https://img.shields.io/badge/dynamic/json?color=orange&label={}%20Reviews&style=flat-square&query=reviews&url=https%3A%2F%2Fciqstats.li2niu.com%2Fapi%2Fstats%3Fappid%3D{}%26domain%3Dall)
'''
for appid, app in app_dict.items():
    if app['total_downloads'] <= 1000:
        continue
    urlencoded_app_name = urllib.parse.quote(
        app['app_name'])
    print(template.format(app['app_name'], urlencoded_app_name, appid, app['app_name'], urlencoded_app_name, appid, app['app_name'], urlencoded_app_name,
          appid, app['app_name'], urlencoded_app_name, appid, app['app_name'], urlencoded_app_name, appid, app['app_name'], urlencoded_app_name, appid))

```

## Intro

Only 2 interfaces now.

- `/api/stats` is used to calculate some stuff about one single `app` with appid in the end of its link
- `/api/total` is used to calculate some stuff about one single `developer` with developerid in the end of his or her homepage link

### Local

```
curl http://localhost:3000/api/stats?appid=dc6ceca8-6ec6-49f2-b711-4ebc0d347177&domain=all

{
    "date": "2022_11_29",
    "downloads": 105224,
    "ratings": "4.5",
    "reviews": 307
}
```

```
curl http://localhost:3000/api/total?developerid=876cfd5e-4e42-48ca-8869-cd7c59235573&domain=cn

{
    "date": "2022_11_29",
    "developer_name": "Newrathon",
    "downloads": 3517
}
```

### Online

```
curl https://ciqstats.li2niu.com/api/stats?appid=dc6ceca8-6ec6-49f2-b711-4ebc0d347177&domain=all
curl https://ciqstats.li2niu.com/api/total?developerid=876cfd5e-4e42-48ca-8869-cd7c59235573&domain=all

```

### Params

#### /api/stats

##### Params

| param  | must | type | default | values                                                                                                          | note                                                                           |
| ------ | ---- | ---- | ------- | --------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ |
| appid  | Y    | str  |         | dc6ceca8-6ec6-49f2-b711-4ebc0d347177 in https://apps.garmin.com/en-US/apps/dc6ceca8-6ec6-49f2-b711-4ebc0d347177 | The last part of the app url                                                   |
| domain | N    | str  | all     | all,cn,com                                                                                                      | The top doamin of app, Rest of the world(com), China mainland(cn), All(com+cn) |

##### Results

| param     | type   | note                                                                                                               |
| --------- | ------ | ------------------------------------------------------------------------------------------------------------------ |
| date      | str    | The date of the info queried e.g. 2022_11_28                                                                       |
| downloads | number | The download number of the app                                                                                     |
| ratings   | str    | The rating of the app. If the domain is specified to 'all', the result will be Weighted Average of 'com' and 'cn'. |
| reviews   | number | The reviews amount of the app                                                                                      |

#### /api/total

##### Params

| param       | must | type | default | values                                                                                                                    | note                                                                           |
| ----------- | ---- | ---- | ------- | ------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ |
| developerid | Y    | str  |         | 876cfd5e-4e42-48ca-8869-cd7c59235573 in https://apps.garmin.com/en-US/developer/876cfd5e-4e42-48ca-8869-cd7c59235573/apps | The part between `developer/` and `/app` in the developer homepage url         |
| domain      | N    | str  | all     | all,cn,com                                                                                                                | The top doamin of app, Rest of the world(com), China mainland(cn), All(com+cn) |

##### Results

| param          | type   | note                                         |
| -------------- | ------ | -------------------------------------------- |
| date           | str    | The date of the info queried e.g. 2022_11_28 |
| downloads      | number | The download number of the app               |
| developer_name | str    | Developer name                               |

## Note

[ciqreviews](https://github.com/Likenttt/connect-iq-spam-reviews)
